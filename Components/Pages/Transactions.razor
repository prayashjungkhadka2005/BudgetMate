@page "/transactions"

<h3>Transactions</h3>

<div class="transaction-container">
    <div class="transaction-box">
        <form action="/" method="post">
            <!-- Transaction Type Dropdown -->
            <div class="transaction-row">
                <div class="trow-title">Transaction Type</div>
                <div class="trow-field">
                    <select name="transaction-type" id="transaction-type">
                        <option value="expense">Debit</option>
                        <option value="income">Credit</option>
                        <option value="debt">Debt</option>
                    </select>
                </div>
            </div>

            <!-- Transaction Title -->
            <div class="transaction-row">
                <div class="trow-title">Transaction Title</div>
                <div class="trow-field">
                    <input type="text" placeholder="Office Rent" id="transaction-title">
                </div>
            </div>

            <!-- Amount -->
            <div class="transaction-row">
                <div class="trow-title">Amount</div>
                <div class="trow-field">
                    <input type="text" placeholder="$100" id="transaction-amount">
                </div>
            </div>

            <!-- Tags -->
            <div class="transaction-row">
                <div class="trow-title">Tags</div>
                <div class="trow-field" id="tags-container">
                    <!-- Tags will be dynamically updated here -->
                </div>

                <!-- Custom Tag Input -->
                <div class="custom-tag-input" style="display: none;">
                    <input type="text" placeholder="Enter custom tag..." id="custom-tag-input">
                </div>
            </div>

            <!-- Submit Button -->
            <div class="transaction-row">
                <div class="trow-field">
                    <button type="submit">Submit</button>
                </div>
            </div>
        </form>
    </div>
</div>

<script>
    // Elements
    const transactionTypeSelect = document.getElementById('transaction-type');
    const tagsContainer = document.getElementById('tags-container');
    const customTagInput = document.querySelector('.custom-tag-input');
    const customTagInputField = document.getElementById('custom-tag-input');

    // Function to update form based on transaction type
    function updateFormFields() {
        const selectedType = transactionTypeSelect.value;

        // Reset tag container
        tagsContainer.innerHTML = '';
        customTagInput.style.display = 'none';

        // Define tags based on selected transaction type
        let tags = [];

        if (selectedType === 'expense') { // Debit
            tags = ['Clothes', 'Rent', 'Groceries'];
        } else if (selectedType === 'income') { // Credit
            tags = ['Salary', 'Gifts', 'Savings', 'Refunds'];
        } else if (selectedType === 'debt') { // Debt
            tags = ['Loan', 'Repayment', 'Credit'];
        }

        // Add the tag buttons dynamically
        tags.forEach(tag => {
            const tagButton = document.createElement('div');
            tagButton.classList.add('tag-button');
            tagButton.textContent = tag;
            tagButton.onclick = () => toggleTag(tagButton, false);
            tagsContainer.appendChild(tagButton);
        });

        // Add the custom tag button
        const customTagButton = document.createElement('div');
        customTagButton.classList.add('tag-button');
        customTagButton.textContent = 'Custom Tag';
        customTagButton.onclick = () => toggleTag(customTagButton, true);
        tagsContainer.appendChild(customTagButton);
    }

    // Function to toggle tag selection
    function toggleTag(button, isCustom) {
        const allTags = document.querySelectorAll('.tag-button');
        allTags.forEach(tag => tag.classList.remove('selected'));

        button.classList.toggle('selected');

        // Show/Hide custom tag input based on selection
        customTagInput.style.display = isCustom && button.classList.contains('selected') ? 'block' : 'none';

        // Clear custom tag input field if not selected
        if (!isCustom || !button.classList.contains('selected')) {
            customTagInputField.value = '';
        }
    }

    // Initialize form when the page loads
    updateFormFields();

    // Update form when transaction type changes
    transactionTypeSelect.addEventListener('change', updateFormFields);
</script>


<!-- Add some CSS for styling the tags -->
<style>
    .tag-button {
        border: 0.5px solid #293198;
        display: inline-block;
        padding: 5px 14px;
        margin: 0px;
        background-color: white;
        border-radius: 6px;

        cursor: pointer;
        transition: background-color 0.3s ease;
        color: #293198;
    }

        .tag-button.selected {
            background-color: #293198;
            color: white;
            border-color: #293198;
        }

    #tags-container {
        display: flex;
        flex-wrap: wrap;
        justify-content: start;
        gap: 10px;
    }

    .custom-tag-input {
        margin-top: 10px;
    }
</style>
